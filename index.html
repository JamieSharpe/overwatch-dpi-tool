<html>
  <head>
    <meta charset="UTF-8">
    <title>Overwatch DPI Tool</title>
    <style>
      .container {
        display: flex;
        flex-direction: column;
        width: 300px;
        align-items: flex-end;
      }

      input {
        width: 60px;
      }

      .error {
        background-color: pink;
      }

      .pass {
        background-color: skyblue;
      }

      #dotpdeg {
        border-style: double;
      }
    </style>
  </head>
  <body>
    <h1>Overwatch DPI Tool</h1>
    <p>
      Low DPI can cause a reticle to skip over hitboxes.
    </p>
    <p>
      Imagine in the extreme case where a DPI hipster plays using 1 DPI and hacks in-game sensitivity to allow
      the sensitivity to be set to 4000. This actually results in a very competitive 34.64 cm/360°, but reticle
      will be skipping by 26.4° at a time!  The DPI hipster will not be able to hit anything.
    </p>
    <p>
      How much DPI does one need? What is enough DPI such that the reticle can be places anywhere on the screen?
      This depends a few factors, DPI, in-game sensitiviy, FOV, screen resolution, and screen ratio.
    </p>
    <p>
      This tool will calculate if a given DPI, in-game sensitiviy, and FOV is good enough for various screen sizes.
    </p>
    <p>
      The key thing to figure out is for a given DPI, in-game sensitiviy, and FOV, how many samples per degree does that
      that result in.  This the overall sampling rate of the mouse.  This is then compared to the actual resolution
      of various monitors.  If sampling rate is 2x of the resolution of the monitor for a single degree, this means
      the settings is enough to reach any part of the monitor.
    </p>
    <p>
      The sampling rate has to be 2x of the resolution due to
      <a href="https://en.wikipedia.org/wiki/Shannon–Hartley_theorem">Shannon's law</a>. For our purposes this effective
      halfs the calculated sample/degree.
    </p>
    <p>
      To use this tool enter your DPI, in-game sensitiviy, and FOV, then find your screen resolution.  If
      Shannon's law sample/degree is greater than your screen's pixel/degree, then it passes with blue, otherwise
      it fails with red.
    </p>
    <p>
      If you have any questions feel free to tweet me <a href="https://twitter.com/pyrolistical">@pyrolistical</a>.
    </p>
    <h2>Inputs</h2>
    <div class="container">
      <label>DPI <input id="dpi" type="text" value="400" onkeyup="calculate()"/></label>
      <label>In-game sensitivity <input id="sensitvity" type="text" value="10" onkeyup="calculate()"/></label>
      <label>FOV <input id="fov" type="text" value="103" onkeyup="calculate()"/></label>
    </div>
    <hr/>
    <h2>Outputs</h2>
    <div class="container" id="outputs">
      <label>Inch/360° <input id="inchp360" type="text" value="" readonly disabled/></label>
      <label>CM/360° <input id="cmp360" type="text" value="" readonly disabled/></label>
      <label>Samples/degree <input id="rawdotpdeg" type="text" value="" readonly disabled/></label>
      <label>Shannon's law samples/degree <input id="dotpdeg" type="text" value="" readonly disabled/></label>
    </div>

    <script type="text/javascript">
      var factors = {
        "1280x720": { "width": 1280, "height": 720, "factor": 16/9 },
        "1440x900": { "width": 1440, "height": 900, "factor": 16/10 },
        "1600x900": { "width": 1600, "height": 900, "factor": 16/9 },
        "1680x1050": { "width": 1680, "height": 1050, "factor": 16/10 },
        "1920x1080": { "width": 1920, "height": 1080, "factor": 16/9 },
        "2560x1080": { "width": 2560, "height": 1080, "factor": 64/27 },
        "2560x1440": { "width": 2560, "height": 1440, "factor": 16/9 },
        "3440x1440": { "width": 2560, "height": 1080, "factor": 64/27 },
        "3840x2160": { "width": 3840, "height": 2160, "factor": 16/9 }
      };

      function populate_rez() {
        var out = document.getElementById("outputs");
        Object.keys(factors).forEach(function(rez) {
          var label = document.createElement("label");
          label.innerHTML = "Pixel/degree @ " + rez + " <input id=" + rez + " type=text readonly disabled/>"
          out.appendChild(label);
        });
      }

      function roundTwoPlaces(number) {
        return Math.round(100 * number) / 100;
      }

      function calculate() {
        var dpi = Number(document.getElementById("dpi").value);
        var sensitvity = Number(document.getElementById("sensitvity").value);
        var fov = Number(document.getElementById("fov").value);

        var inchp360 = (360 * 10 / 3) / (dpi * sensitvity * 0.022);
        var cmp360 = 2.54 * inchp360;
        var rawdotpdeg = dpi * inchp360 / 360;
        var dotpdeg = rawdotpdeg / 2;

        document.getElementById("inchp360").value = roundTwoPlaces(inchp360);
        document.getElementById("cmp360").value = roundTwoPlaces(cmp360);
        document.getElementById("rawdotpdeg").value = roundTwoPlaces(rawdotpdeg);
        document.getElementById("dotpdeg").value = roundTwoPlaces(dotpdeg);

        Object.keys(factors).forEach(function(rez) {
          var info = factors[rez];
          var pixeldeg = info.factor * info.height / fov;

          var outbox = document.getElementById(rez);
          outbox.value = roundTwoPlaces(pixeldeg);
          outbox.className = (pixeldeg > dotpdeg) ? "error" : "pass";
        });
      }

      populate_rez();
      calculate();
    </script>
  </body>
</html>
